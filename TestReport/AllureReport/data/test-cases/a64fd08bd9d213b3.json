{"uid":"a64fd08bd9d213b3","name":"test_create_excel","fullName":"TestCase.Test_create_modules.TestCreateSampleForm#test_create_excel","historyId":"99fe2d41a4af505c3d21d86145e0cb04","time":{"start":1766997204013,"stop":1766997204018,"duration":5},"status":"broken","statusMessage":"playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed","statusTrace":"self = <Test_create_modules.TestCreateSampleForm object at 0x103736510>\npage = <Page url='https://drv-dev-16.shimorelease.com/recent'>\n\n    @pytest.mark.order(5)\n    def test_create_excel(self,page):\n        new_page=CreateModulesPage(page)\n>       new_page.create_excel(\"创建专业表格\")\n\nTestCase/Test_create_modules.py:29: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nPages/CreateModulesPage.py:113: in create_excel\n    self.click_create_button()\nPages/CreateModulesPage.py:31: in click_create_button\n    self.ele_to_be_visible_force(self.create_button, timeout=10)\nBasePage/BasePage.py:108: in ele_to_be_visible_force\n    ele.wait_for(state=\"visible\", timeout=500)\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/sync_api/_generated.py:18323: in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_locator.py:670: in wait_for\n    await self._frame.wait_for_selector(\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_frame.py:317: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:62: in send\n    return await self._connection.wrap_api_call(\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:492: in wrap_api_call\n    return await cb()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x103c56850>, method = 'waitForSelector'\nparams = {'selector': '//*[@id=\"desktopLayoutContainer\"]/div/aside/div/div[1]/button', 'state': 'visible', 'strict': True, 'timeout': 500}\nreturn_as_dict = False\n\n    async def inner_send(\n        self, method: str, params: Optional[Dict], return_as_dict: bool\n    ) -> Any:\n        if params is None:\n            params = {}\n        callback = self._connection._send_message_to_server(\n            self._object, method, params\n        )\n        if self._connection._error:\n            error = self._connection._error\n            self._connection._error = None\n            raise error\n        done, _ = await asyncio.wait(\n            {\n                self._connection._transport.on_error_future,\n                callback.future,\n            },\n            return_when=asyncio.FIRST_COMPLETED,\n        )\n        if not callback.future.done():\n            callback.future.cancel()\n>       result = next(iter(done)).result()\nE       playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:100: TargetClosedError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1766997151690,"stop":1766997151744,"duration":54},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_fail_for_invalid_template_variable","time":{"start":1766997151744,"stop":1766997151745,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1766997151745,"stop":1766997152495,"duration":750},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"django_test_environment","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clear_auth","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"django_db_blocker","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1766997151745,"stop":1766997151745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1766997152495,"stop":1766997152524,"duration":29},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logged_in_page","time":{"start":1766997168418,"stop":1766997171700,"duration":3282},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_setup_unittest","time":{"start":1766997168418,"stop":1766997168418,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_db_marker","time":{"start":1766997204012,"stop":1766997204012,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_dj_autoclear_mailbox","time":{"start":1766997204012,"stop":1766997204012,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_clear_site_cache","time":{"start":1766997204012,"stop":1766997204012,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_set_urlconf","time":{"start":1766997204012,"stop":1766997204012,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1766997204013,"stop":1766997204013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_live_server_helper","time":{"start":1766997204013,"stop":1766997204013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch","time":{"start":1766997204013,"stop":1766997204013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_template_string_if_invalid_marker","time":{"start":1766997204013,"stop":1766997204013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed","statusTrace":"self = <Test_create_modules.TestCreateSampleForm object at 0x103736510>\npage = <Page url='https://drv-dev-16.shimorelease.com/recent'>\n\n    @pytest.mark.order(5)\n    def test_create_excel(self,page):\n        new_page=CreateModulesPage(page)\n>       new_page.create_excel(\"创建专业表格\")\n\nTestCase/Test_create_modules.py:29: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nPages/CreateModulesPage.py:113: in create_excel\n    self.click_create_button()\nPages/CreateModulesPage.py:31: in click_create_button\n    self.ele_to_be_visible_force(self.create_button, timeout=10)\nBasePage/BasePage.py:108: in ele_to_be_visible_force\n    ele.wait_for(state=\"visible\", timeout=500)\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/sync_api/_generated.py:18323: in wait_for\n    self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_locator.py:670: in wait_for\n    await self._frame.wait_for_selector(\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_frame.py:317: in wait_for_selector\n    await self._channel.send(\"waitForSelector\", locals_to_params(locals()))\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:62: in send\n    return await self._connection.wrap_api_call(\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:492: in wrap_api_call\n    return await cb()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Channel object at 0x103c56850>, method = 'waitForSelector'\nparams = {'selector': '//*[@id=\"desktopLayoutContainer\"]/div/aside/div/div[1]/button', 'state': 'visible', 'strict': True, 'timeout': 500}\nreturn_as_dict = False\n\n    async def inner_send(\n        self, method: str, params: Optional[Dict], return_as_dict: bool\n    ) -> Any:\n        if params is None:\n            params = {}\n        callback = self._connection._send_message_to_server(\n            self._object, method, params\n        )\n        if self._connection._error:\n            error = self._connection._error\n            self._connection._error = None\n            raise error\n        done, _ = await asyncio.wait(\n            {\n                self._connection._transport.on_error_future,\n                callback.future,\n            },\n            return_when=asyncio.FIRST_COMPLETED,\n        )\n        if not callback.future.done():\n            callback.future.cancel()\n>       result = next(iter(done)).result()\nE       playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_connection.py:100: TargetClosedError","steps":[{"name":"添加失败截图","time":{"start":1766997204153,"stop":1766997204160,"duration":7},"status":"passed","steps":[],"attachments":[{"uid":"e2e39d935e743c13","name":"错误信息","source":"e2e39d935e743c13.attach","type":"text/plain","size":60}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"page::0","time":{"start":1766997204161,"stop":1766997204191,"duration":30},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_live_server_helper::0","time":{"start":1766997204192,"stop":1766997204192,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_set_urlconf::0","time":{"start":1766997204192,"stop":1766997204192,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch::0","time":{"start":1766997204192,"stop":1766997204192,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_django_setup_unittest::0","time":{"start":1766997204651,"stop":1766997204651,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"logged_in_page::0","time":{"start":1766997204652,"stop":1766997204652,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context::0","time":{"start":1766997204652,"stop":1766997204664,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1766997204665,"stop":1766997204779,"duration":114},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clear_auth::0","time":{"start":1766997204782,"stop":1766997204782,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"django_test_environment::0","time":{"start":1766997204785,"stop":1766997204785,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_fail_for_invalid_template_variable::0","time":{"start":1766997204786,"stop":1766997204786,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"order(5)"},{"name":"parentSuite","value":"TestCase"},{"name":"suite","value":"Test_create_modules"},{"name":"subSuite","value":"TestCreateSampleForm"},{"name":"host","value":"AlindeMacBook-Pro.local"},{"name":"thread","value":"11760-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"TestCase.Test_create_modules"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"250daf0d4d2768fd","status":"broken","statusDetails":"playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed","time":{"start":1766997191463,"stop":1766997197238,"duration":5775}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":["order(5)"]},"source":"a64fd08bd9d213b3.json","parameterValues":[]}