{"name": "Create_Sample_Form_success_表单创建成功", "status": "broken", "statusDetails": {"message": "Exception: ❌ 表单创建操作失败，错误：超时15秒，元素仍未可见！定位器：//*[@id=\":r4u:\"]/div/div/div[1]/div/div/img，frame：None", "trace": "self = <Test_create_sample_form.TestCreateSampleForm object at 0x1082f7b50>\nlogged_in_page = <Page url='https://drv-dev-16.shimorelease.com/recent'>\nCaseData = {'url': '/recent', '功能': '创建表单', '是否执行': 'Y', '用例标题': '表单创建成功', ...}\n\n    @pytest.mark.order(2)  # 登录用例之后执行\n    @AllurePretty.AllurePretty_Warpper\n    # 参数化：读取创建表单的测试数据\n    @pytest.mark.parametrize(\n        \"CaseData\",\n        ReadYaml(os.path.join(Config.test_datas_dir, \"TestCreateForm.yaml\")).read()\n    )\n    def test_create_sample_form(self, logged_in_page, CaseData):\n        page = logged_in_page\n        # 导航到目标页面（如果当前不在目标页面）\n        target_url = Config.Base_url + CaseData.get(\"url\", \"/recent\")\n        if page.url != target_url and \"about:blank\" in page.url:\n            page.goto(target_url, wait_until=\"domcontentloaded\", timeout=30000)\n            page.wait_for_load_state(\"networkidle\", timeout=15000)\n    \n        create_form_page = CreateFormPage(page)\n        current_url = page.url\n        print(f\"✅ 登录后当前页面：{current_url}\")\n    \n        # 3. 执行创建表单操作（每个操作前等待元素，避免点击失败）\n        try:\n            # 点击创建按钮\n            create_form_page.click_create_button()\n            print(\"✅ 点击创建按钮成功\")\n    \n            # 悬浮到表单按钮\n            create_form_page.hover_hover_form_button()\n            print(\"✅ 悬浮表单按钮成功\")\n    \n            # 点击创建示例表单按钮\n>           create_form_page.click_create_sample_form_button()\n\nTestCase/Test_create_sample_form.py:41: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\nPages/CreateFormPage.py:44: in click_create_sample_form_button\n    self.ele_to_be_visible_force(self.create_sample_form_button, timeout=15)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <Pages.CreateFormPage.CreateFormPage object at 0x108906390>\nlocator = '//*[@id=\":r4u:\"]/div/div/div[1]/div/div/img', frame_locator = None\ntimeout = 15\n\n    def ele_to_be_visible_force(self, locator, frame_locator=None, timeout: int = 5):\n        # 1. 区分frame内/外元素，获取正确的等待对象\n        wait_target = self.page\n        if frame_locator is not None:\n            # 先定位frame，再基于frame等待元素\n            wait_target = self.page.frame_locator(frame_locator)\n    \n        # 2. 循环重试等待元素可见（每500ms检查一次）\n        total_checks = timeout * 2  # 总检查次数（5秒→10次）\n        for _ in range(total_checks):\n            try:\n                # 关键修正：移除frame参数，根据wait_target（page/frame）调用wait_for_selector\n                wait_target.wait_for_selector(\n                    locator,  # 元素选择器（字符串，必传）\n                    state=\"visible\",  # 等待元素\"可见\"\n                    timeout=500  # 单次检查超时（500ms）\n                )\n                # 定位元素并二次确认可见性\n                if frame_locator is not None:\n                    ele = self.page.frame_locator(frame_locator).locator(locator)\n                else:\n                    ele = self.page.locator(locator)\n    \n                if ele.is_visible():\n                    return ele\n            except PlaywrightTimeoutError:\n                # 单次超时不抛错，继续重试\n                continue\n    \n        # 3. 总超时后抛明确异常\n>       raise Exception(f\"超时{timeout}秒，元素仍未可见！定位器：{locator}，frame：{frame_locator}\")\nE       Exception: 超时15秒，元素仍未可见！定位器：//*[@id=\":r4u:\"]/div/div/div[1]/div/div/img，frame：None\n\nBasePage/BasePage.py:109: Exception\n\nDuring handling of the above exception, another exception occurred:\n\nself = <Test_create_sample_form.TestCreateSampleForm object at 0x1082f7b50>\nlogged_in_page = <Page url='https://drv-dev-16.shimorelease.com/recent'>\nCaseData = {'url': '/recent', '功能': '创建表单', '是否执行': 'Y', '用例标题': '表单创建成功', ...}\n\n    @pytest.mark.order(2)  # 登录用例之后执行\n    @AllurePretty.AllurePretty_Warpper\n    # 参数化：读取创建表单的测试数据\n    @pytest.mark.parametrize(\n        \"CaseData\",\n        ReadYaml(os.path.join(Config.test_datas_dir, \"TestCreateForm.yaml\")).read()\n    )\n    def test_create_sample_form(self, logged_in_page, CaseData):\n        page = logged_in_page\n        # 导航到目标页面（如果当前不在目标页面）\n        target_url = Config.Base_url + CaseData.get(\"url\", \"/recent\")\n        if page.url != target_url and \"about:blank\" in page.url:\n            page.goto(target_url, wait_until=\"domcontentloaded\", timeout=30000)\n            page.wait_for_load_state(\"networkidle\", timeout=15000)\n    \n        create_form_page = CreateFormPage(page)\n        current_url = page.url\n        print(f\"✅ 登录后当前页面：{current_url}\")\n    \n        # 3. 执行创建表单操作（每个操作前等待元素，避免点击失败）\n        try:\n            # 点击创建按钮\n            create_form_page.click_create_button()\n            print(\"✅ 点击创建按钮成功\")\n    \n            # 悬浮到表单按钮\n            create_form_page.hover_hover_form_button()\n            print(\"✅ 悬浮表单按钮成功\")\n    \n            # 点击创建示例表单按钮\n            create_form_page.click_create_sample_form_button()\n            print(\"✅ 点击创建示例表单按钮成功\")\n        except Exception as e:\n>           raise Exception(f\"❌ 表单创建操作失败，错误：{str(e)}\")\nE           Exception: ❌ 表单创建操作失败，错误：超时15秒，元素仍未可见！定位器：//*[@id=\":r4u:\"]/div/div/div[1]/div/div/img，frame：None\n\nTestCase/Test_create_sample_form.py:44: Exception"}, "steps": [{"name": "添加失败截图", "status": "passed", "attachments": [{"name": "失败截图:", "source": "16e75567-7b2b-4de5-ab89-2d402e1332db-attachment.png", "type": "image/png"}], "start": 1766719114236, "stop": 1766719114380}], "parameters": [{"name": "CaseData", "value": "{'用例编号': 'Create_Sample_Form_success', '功能': '创建表单', '是否执行': 'Y', '用例标题': '表单创建成功', 'url': '/recent'}"}], "start": 1766719092666, "stop": 1766719114225, "uuid": "e7cdb2ab-6bc6-4591-a1f3-85fef602a4c7", "historyId": "6b3691d0acee37b01b81c0240f9c5681", "testCaseId": "34bb29de03990a62dc952b629161dd58", "fullName": "TestCase.Test_create_sample_form.TestCreateSampleForm#test_create_sample_form", "labels": [{"name": "feature"}, {"name": "story", "value": "创建表单"}, {"name": "severity"}, {"name": "tag", "value": "order(2)"}, {"name": "parentSuite", "value": "TestCase"}, {"name": "suite", "value": "Test_create_sample_form"}, {"name": "subSuite", "value": "TestCreateSampleForm"}, {"name": "host", "value": "AlindeMacBook-Pro.local"}, {"name": "thread", "value": "38230-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "TestCase.Test_create_sample_form"}]}